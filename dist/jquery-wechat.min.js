!function(e,n,i){"use strict";var o={options:{}},t=function(e){o.bridge.invoke("sendAppMessage",{appid:f(e,"appid"),img_url:f(e,"img_url"),img_width:f(e,"img_width"),img_height:f(e,"img_height"),link:f(e,"link"),desc:f(e,"desc"),title:f(e,"title")},function(n){e.callback(n.err_msg)})},r=function(e){o.bridge.invoke("shareTimeline",{img_url:f(e,"img_url"),img_width:f(e,"img_width"),img_height:f(e,"img_height"),link:f(e,"link"),desc:f(e,"title"),title:f(e,"title")+" - "+f(e,"desc")},function(n){e.callback(n.err_msg)})},u=function(e){o.bridge.invoke("shareWeibo",{content:f(e,"desc"),url:f(e,"link")},function(n){e.callback(n.err_msg)})},c=function(e){o.bridge.invoke("sendEmail",{content:f(e,"desc")||f(e,"link")},function(n){e.callback(n.err_msg)})},s={network:"getNetworkType",hideToolbar:"hideToolbar",showToolbar:"showToolbar",hideOptionMenu:"hideOptionMenu",showOptionMenu:"showOptionMenu",closeWebView:"closeWindow",scanQRCode:"scanQRCode",preview:"imagePreview"},a={events:{friend:"menu:share:appmessage",moment:"menu:share:timeline",weibo:"menu:share:weibo",email:"menu:share:email"},actions:{friend:t,moment:r,weibo:u,email:c}},d=i(n),l={appid:"",img_url:"",img_width:"60",img_height:"60",link:function(){return e.location.toString()},desc:function(){var e=i('head meta[name="description"]');return e.length>0?e.attr("content"):""},title:function(){return n.title},callback:function(){}},m=function(e){return"function"==typeof e},f=function(e,n){return m(e[n])?e[n]():e[n]},h=function(n){return function(){return"undefined"==typeof e.WeixinJSBridge?void n.reject():(o.bridge=e.WeixinJSBridge,i.each(a.events,function(e,n){o.bridge.on(n,function(){a.actions[e](o.options.bind?i.extend(!1,{},l,o.options):l)})}),void n.resolve())}},p=function(n,t){t=t||{};var r,u=i.Deferred(),c=u.promise();return"undefined"==typeof o.promise?(e.setTimeout(function(){u.reject(new Error("You have to enable wechat functionality first"))},0),c):s[n]?(o.promise.done(function(){r=e.setTimeout(function(){u.resolve()},1e3),o.bridge.invoke(s[n],t,function(n){r&&e.clearTimeout(r),u.resolve(n.err_msg)})}),c):(e.setTimeout(function(){u.reject(new Error("Wrong action"))},0),c)};i.wechat={enable:function(){if(o.promise)return console.warn("wechat already enabled"),o.promise;var n=i.Deferred();return o.promise=n.promise(),"undefined"!=typeof e.WeixinJSBridge?(e.setTimeout(h(n),0),o.promise):(o.timeoutID=e.setTimeout(h(n),3e3),d.on("WeixinJSBridgeReady",function(){e.clearTimeout(o.timeoutID),h(n)()}),o.promise)},destroy:function(){var n=i.Deferred(),t=n.promise();return i.wechat.showMenu(),i.wechat.showToolbar(),i.wechat.resetShareOption(),o.promise&&delete o.promise,d.off("WeixinJSBridgeReady"),e.setTimeout(n.resolve,0),t},showMenu:function(){return p("showOptionMenu")},hideMenu:function(){return p("hideOptionMenu")},showToolbar:function(){return p("showToolbar")},hideToolbar:function(){return p("hideToolbar")},getNetworkType:function(){return p("network")},closeWindow:function(){return p("closeWebView")},scanQRcode:function(){return p("scanQRCode")},preview:function(e){return p("preview",e)},setShareOption:function(e){e&&(o.options=i.extend(!1,{},e),o.options.bind=!0)},resetShareOption:function(){o.options.bind=!1}}}(window,document,jQuery);
//# sourceMappingURL=jquery-wechat.min.js.map